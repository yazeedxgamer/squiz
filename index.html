<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');

        :root {
            --primary-color: #0056b3; /* أزرق داكن */
            --secondary-color: #f4f4f4; /* رمادي فاتح للخلفية */
            --correct-color: #28a745; /* أخضر */
            --incorrect-color: #dc3545; /* أحمر */
            --text-color: #333;
            --container-bg: #ffffff;
            --border-radius: 10px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 25px;
            font-size: 2.5rem;
        }

        .quiz-container {
            background-color: var(--container-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            width: 100%;
            max-width: 800px;
            overflow: hidden;
        }

        .quiz-header {
            padding: 25px;
            background-color: #f9f9f9;
            border-bottom: 1px solid #eee;
        }
        
        #question-counter {
            font-size: 1rem;
            color: #777;
            margin-bottom: 10px;
        }

        #question-text {
            font-size: 1.4rem;
            font-weight: 500;
            line-height: 1.6;
            min-height: 60px;
        }

        .quiz-body {
            padding: 25px;
        }

        .btn-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--container-bg);
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            padding: 15px;
            font-size: 1.1rem;
            text-align: right;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover:not(:disabled) {
            background-color: #f0f0f0;
            border-color: var(--primary-color);
        }

        .btn.correct {
            background-color: #e6f7ec;
            border-color: var(--correct-color);
            color: var(--correct-color);
            font-weight: 700;
        }

        .btn.incorrect {
            background-color: #fdedee;
            border-color: var(--incorrect-color);
            color: var(--incorrect-color);
        }

        .btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        .rationale {
            font-size: 1rem;
            margin-top: 20px;
            padding: 15px;
            border-radius: var(--border-radius);
            background-color: #f9f9f9;
            border: 1px solid #eee;
            line-height: 1.7;
            display: none; /* مخفي افتراضيًا */
        }
        
        .rationale.correct {
            border-left: 5px solid var(--correct-color);
        }

        .rationale.incorrect {
            border-left: 5px solid var(--incorrect-color);
        }
        
        .rationale strong {
            color: var(--primary-color);
        }

        .controls {
            padding: 25px;
            display: flex;
            justify-content: center;
            border-top: 1px solid #eee;
        }

        #next-btn {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 12px 35px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #next-btn:hover {
            background-color: #004494;
        }

        .score-container {
            padding: 40px;
            text-align: center;
            font-size: 1.5rem;
        }
        
        .score-container h2 {
            font-size: 2.2rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .hide {
            display: none;
        }
        
        /* --- أنماط قسم المراجعة --- */
        #review-container h2 {
            text-align: center;
            color: var(--primary-color);
            margin-top: 30px;
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-top: 1px solid #eee;
            padding-top: 25px;
        }
        
        .review-question {
            text-align: right;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .review-question:last-of-type {
            border-bottom: none;
        }
        
        .review-question h4 {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .user-answer, .correct-answer, .review-rationale {
            font-size: 1rem;
            margin-bottom: 8px;
            line-height: 1.6;
        }
        
        .user-answer span.correct-text {
            color: var(--correct-color);
            font-weight: 700;
        }
        
        .user-answer span.incorrect-text {
            color: var(--incorrect-color);
            font-weight: 700;
        }
        
        .correct-answer {
            background-color: #e6f7ec;
            padding: 5px 10px;
            border-radius: 5px;
            border-right: 4px solid var(--correct-color);
        }
        
        .review-rationale {
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 5px;
        }

    </style>
</head>
<body>

    <div class="quiz-container">
        <h1>اختبار الكيمياء الحيوية</h1>
        
        <div id="quiz-content">
            <div class="quiz-header">
                <div id="question-counter"></div>
                <div id="question-text">...</div>
            </div>
            
            <div class="quiz-body">
                <div id="answer-buttons" class="btn-grid">
                    </div>
                <div id="rationale-text" class="rationale"></div>
            </div>

            <div class="controls">
                <button id="next-btn" class="hide">التالي</button>
            </div>
        </div>

        <div id="score-container" class="score-container hide">
            </div>
    </div>

    <script>
        const questions = [
            // --- الفصل الأول: الخلية ---
            {
                question: "ما هو الفرق الرئيسي في مادة DNA بين الخلايا بدائية النواة وحقيقية النواة؟",
                type: 'mc',
                answers: [
                    { text: "في حقيقية النواة، يوجد DNA في النواة ومحاط بغشاء نووي، بينما في بدائية النواة يوجد في السيتوبلازم (منطقة النيوكليوتيد)", correct: true, rationale: "الخلايا حقيقية النواة تحتوي على نواة حقيقية بغشاء نووي، أما بدائية النواة فلا تحتوي غشاء نووي ويوجد DNA في السيتوبلازم." },
                    { text: "في بدائية النواة، يوجد DNA في النواة، بينما في حقيقية النواة يوجد في السيتوبلازم", correct: false, rationale: "هذا عكس الواقع تماماً. الخلايا حقيقية النواة هي التي لها نواة حقيقية." },
                    { text: "كلا النوعين لا يحتوي على غشاء نووي، لكن DNA في حقيقية النواة أكبر حجماً", correct: false, rationale: "الخلايا حقيقية النواة تمتلك غشاءً نووياً يحيط بالـ DNA." },
                    { text: "الخلايا بدائية النواة لا تحتوي على DNA، فقط RNA", correct: false, rationale: "الخلايا بدائية النواة تحتوي على DNA، وهو يعمل كروموسوم واحد." }
                ]
            },
            {
                question: "صح أم خطأ: يتكون الغشاء البلازمي (الخلوي) بشكل أساسي من طبقة مزدوجة من الدهون الفوسفورية (Phospholipids).",
                type: 'tf',
                answers: [
                    { text: "صح", correct: true, rationale: "يتكون الغشاء الخلوي من طبقة مزدوجة (Bilayer) من الدهون الفوسفورية، بالإضافة إلى البروتينات والكولسترول والكربوهيدرات." },
                    { text: "خطأ", correct: false, rationale: "الغشاء الخلوي هو بالفعل طبقة مزدوجة (Bilayer) من الدهون الفوسفورية." }
                ]
            },
            {
                question: "ما هي العضية المسؤولة عن معالجة وتغليف المواد (مثل البروتينات والدهون) وتصديرها إلى خارج الخلية؟",
                type: 'mc',
                answers: [
                    { text: "الشبكة الإندوبلازمية", correct: false, rationale: "الشبكة الإندوبلازمية (خاصة الخشنة) هي موقع بناء البروتينات والدهون، ولكن جهاز جولجي هو الذي يعالجها ويغلفها للتصدير." },
                    { text: "الميتوكوندريا", correct: false, rationale: "الميتوكوندريا هي المسؤولة عن إنتاج الطاقة (ATP) في الخلية عن طريق عمليات الأكسدة." },
                    { text: "جهاز جولجي", correct: true, rationale: "المواد المراد تصديرها خارج الخلية (Exocytosis) تعالج داخل جهاز جولجي وتغلف بحويصلات غشائية." },
                    { text: "اللايزوسوم (الجسيم الحال)", correct: false, rationale: "اللايزوسوم يحتوي على إنزيمات التحلل لهضم وتكسير المواد، وليس لتصديرها." }
                ]
            },
            {
                question: "العضية التي تحتوي على إنزيمات الأكسدة التي تحول الهيدروجين إلى فوق أكسيد الهيدروجين ($H_{2}O_{2}$) ثم تحطمه إلى ماء وأكسجين هي:",
                type: 'mc',
                answers: [
                    { text: "اللايزوسوم", correct: false, rationale: "اللايزوسوم يحتوي إنزيمات التحلل (الهضم)، وليس إنزيمات الأكسدة لـ H2O2." },
                    { text: "البيروكسيزوم", correct: true, rationale: "البيروكسيزوم يحتوي على إنزيمات الأكسدة التي تكون فوق أكسيد الهيدروجين (H2O2) ثم تحطمه بواسطة إنزيم Catalase." },
                    { text: "جهاز جولجي", correct: false, rationale: "جهاز جولجي مسؤول عن التغليف والتصدير خارج الخلية." },
                    { text: "الميتوكوندريا", correct: false, rationale: "الميتوكوندريا مسؤولة عن إنتاج الطاقة (التنفس الخلوي)." }
                ]
            },
            {
                question: "ما هي العناصر الأربعة التي تشكل أكثر من 99% من معظم الخلايا الحية؟",
                type: 'mc',
                answers: [
                    { text: "الكربون، الهيدروجين، الأكسجين، النيتروجين", correct: true, rationale: "الهيدروجين والأكسجين والكربون والنيتروجين تشكل أكثر من 99% من معظم الخلايا الحية." },
                    { text: "الكربون، الصوديوم، البوتاسيوم، الكالسيوم", correct: false, rationale: "الصوديوم والبوتاسيوم والكالسيوم هي أيونات مهمة، لكنها لا تشكل النسبة الأكبر مقارنة بـ C, H, O, N." },
                    { text: "الكربون، الفوسفور، الكبريت، الأكسجين", correct: false, rationale: "الفوسفور (في ATP) والكبريت (في Acetyl CoA) مهمان لنقل الطاقة، لكن النيتروجين والهيدروجين أساسيان وبنسبة أعلى." },
                    { text: "الحديد، النحاس، الأكسجين، الهيدروجين", correct: false, rationale: "الحديد والنحاس مهمان لنقل الإلكترونات، لكن الكربون والنيتروجين يشكلان نسبة أكبر بكثير." }
                ]
            },
            // --- الفصل الثاني: الماء ---
            {
                question: "صح أم خطأ: من الخواص الفيزيائية للماء أن درجة غليانه وانصهاره عالية مقارنة بالسوائل الأخرى.",
                type: 'tf',
                answers: [
                    { text: "صح", correct: true, rationale: "من خواص الماء أن درجة غليانه (100 م) وانصهاره (0 م) عالية، وكذلك له حرارة كامنة للتبخر عالية." },
                    { text: "خطأ", correct: false, rationale: "الماء يتميز بارتفاع درجة غليانه وانصهاره بسبب الروابط الهيدروجينية القوية بين جزيئاته." }
                ]
            },
            {
                question: "ما هو نظام التحكم (المحلول المنظم) الأساسي للرقم الهيدروجيني في بلازما الدم؟",
                type: 'mc',
                answers: [
                    { text: "نظام الفوسفات", correct: false, rationale: "نظام الفوسفات هو أحد المنظمات الفسيولوجية الهامة، لكنه يعمل بشكل أساسي داخل الخلايا، بينما نظام البيكربونات هو الأساسي في بلازما الدم." },
                    { text: "نظام الأسيتات", correct: false, rationale: "نظام الأسيتات (حمض الخليك وخلات الصوديوم) هو مثال على المحاليل المنظمة، ولكنه ليس المنظم الأساسي في دم الإنسان." },
                    { text: "نظام البيكربونات", correct: true, rationale: "نظام التحكم الأساسي للرقم الهيدروجيني في بلازما الدم هو نظام البيكربونات، الذي يتألف من حمض الكربونيك (H2CO3) والبيكربونات (HCO3-)." },
                    { text: "حمض الهيدروكلوريك", correct: false, rationale: "حمض الهيدروكلوريك هو حمض قوي، وليس محلولاً منظماً." }
                ]
            },
            {
                question: "عند دخول مادة قاعدية إلى الدم، ماذا يحدث لنظام البيكربونات المنظم؟",
                type: 'mc',
                answers: [
                    { text: "يتفاعل حمض الكربونيك ($H_{2}CO_{3}$) معها وتزداد كمية البيكربونات ($HCO_{3}^{-}$)", correct: true, rationale: "عند دخول مادة قاعدية (basic substance)، يتفاعل معها حمض الكربونيك (H2CO3)، مما يؤدي إلى زيادة في تركيز البيكربونات (HCO3-)." },
                    { text: "تتفاعل البيكربونات ($HCO_{3}^{-}$) معها وتزداد كمية حمض الكربونيك ($H_{2}CO_{3}$)", correct: false, rationale: "هذا يحدث عند دخول مادة حامضية. القاعدة تتفاعل مع الحمض (حمض الكربونيك)." },
                    { text: "لا يتغير شيء", correct: false, rationale: "وظيفة المحلول المنظم هي التفاعل لمقاومة التغير في الـ pH، لذلك يجب أن تتغير تراكيز مكوناته." },
                    { text: "يقل تركيز كلا من حمض الكربونيك والبيكربونات", correct: false, rationale: "عند تفاعل القاعدة مع حمض الكربونيك، يقل حمض الكربونيك ويزيد البيكربونات." }
                ]
            },
            {
                question: "وفقاً للسلايدات، إذا انخفض الرقم الهيدروجيني لدم الإنسان إلى أقل من 7.0، فإن الموت قد يحدث نتيجة لـ:",
                type: 'mc',
                answers: [
                    { text: "الكزاز (Tetany)", correct: false, rationale: "الكزاز يحدث إذا ارتفع الرقم الهيدروجيني إلى 7.8 (زيادة القاعدية - Alkalosis)." },
                    { text: "الغيبوبة الحمضية (Acidosis)", correct: true, rationale: "عند درجة أقل من 7.0 يموت الإنسان نتيجة الغيبوبة الحمضية (Acidotic Coma)." },
                    { text: "الوضع الطبيعي", correct: false, rationale: "المدى الطبيعي لدم الإنسان قريب جداً من 7.4." },
                    { text: "فشل نظام الفوسفات", correct: false, rationale: "النتيجة السريرية المباشرة لانخفاض الـ pH الحاد (أقل من 7.0) هي الغيبوبة الحمضية." }
                ]
            },
            // --- الفصل الثالث: الكربوهيدرات ---
            {
                question: "صح أم خطأ: السكر الذي يحتوي على مجموعة ألدهيد (CHO) يسمى كيتوز (Ketose).",
                type: 'tf',
                answers: [
                    { text: "صح", correct: false, rationale: "السكر الذي يحتوي على مجموعة ألدهيد يسمى ألدوز (Aldose). السكر الذي يحتوي على مجموعة كيتون (C=O) يسمى كيتوز (Ketose)." },
                    { text: "خطأ", correct: true, rationale: "السكر الذي يحتوي على مجموعة ألدهيد يسمى ألدوز (Aldose)، أما الكيتوز فيحتوي على مجموعة كيتون." }
                ]
            },
            {
                question: "لحساب عدد المتشابهات الفراغية ($2^n$) لسكر سداسي ألدوزي (Aldohexose)، كم تساوي 'n' (عدد ذرات الكربون غير المتماثلة)؟",
                type: 'mc',
                answers: [
                    { text: "2", correct: false, rationale: "عدد ذرات الكربون غير المتماثلة في الألدوهكسوز هو 4 (نطرح ذرة الكربون الأولى C1 الألدهيدية والأخيرة C6)." },
                    { text: "3", correct: false, rationale: "الرقم 3 هو عدد ذرات الكربون غير المتماثلة في الكيتوهكسوز (Ketohexose)." },
                    { text: "4 (القاعدة: الألدوزي نطرح 2)", correct: true, rationale: "الألدوهكسوز (6 كربون) يحتوي على 4 ذرات كربون غير متماثلة (n=4)، لأن ذرة الكربون C1 (الألدهيد) و C6 (الكحول الأولي) متماثلة. (القاعدة: n = 6-2 = 4)." },
                    { text: "6", correct: false, rationale: "الرقم 6 هو العدد الكلي لذرات الكربون، وليس عدد الذرات غير المتماثلة." }
                ]
            },
            {
                question: "لحساب عدد المتشابهات الفراغية ($2^n$) لسكر سداسي كيتوني (Ketohexose) مثل الفركتوز، كم تساوي 'n' (عدد ذرات الكربون غير المتماثلة)؟",
                type: 'mc',
                answers: [
                    { text: "4", correct: false, rationale: "الرقم 4 هو عدد ذرات الكربون غير المتماثلة في الألدوهكسوز (Aldohexose)." },
                    { text: "3 (القاعدة: الكيتوني نطرح 3)", correct: true, rationale: "الكيتوهكسوز (6 كربون) يحتوي على 3 ذرات كربون غير متماثلة (n=3)، لأن C1 (كحول أولي), C2 (الكيتون), و C6 (كحول أولي) تعتبر متماثلة. (القاعدة: n = 6-3 = 3)." },
                    { text: "5", correct: false, rationale: "عدد ذرات الكربون غير المتماثلة هو 3 فقط (C3, C4, C5)." },
                    { text: "6", correct: false, rationale: "الرقم 6 هو العدد الكلي لذرات الكربون." }
                ]
            },
             {
                question: "كم عدد المتشابهات الفراغية المحتملة لسكر سداسي ألدوزي (Aldohexose)؟",
                type: 'mc',
                answers: [
                    { text: "8 ($2^3$)", correct: false, rationale: "عدد المتشابهات 8 هو للكيتوهكسوز (n=3)، بينما الألدوهكسوز له n=4." },
                    { text: "16 ($2^4$)", correct: true, rationale: "الألدوهكسوز له 4 ذرات كربون غير متماثلة (n=4). وعليه، عدد المتشابهات الفراغية هو 2^n = 2^4 = 16." },
                    { text: "4 ($2^2$)", correct: false, rationale: "عدد المتشابهات 4 هو للألدوتتروز (n=2)." },
                    { text: "32 ($2^5$)", correct: false, rationale: "الألدوهكسوز له 4 ذرات كربون غير متماثلة فقط." }
                ]
            },
            {
                question: "ما هو نوع التشابه الفراغي بين D-Glucose و D-Galactose؟",
                type: 'mc',
                answers: [
                    { text: "إبيمرات (Epimers) عند C2", correct: false, rationale: "التشابه بين D-Glucose و D-Mannose هو إبيمر عند C2." },
                    { text: "إبيمرات (Epimers) عند C4", correct: true, rationale: "D-جلوكوز و D-جلاكتوز هما إبيمرات (epimers) فيما يتعلق بذرة الكربون رقم 4، حيث يختلفان فقط في الترتيب الفراغي حول هذه الذرة." },
                    { text: "أنومرات (Anomers)", correct: false, rationale: "الأنومرات (ألفا وبيتا) تصف الاختلاف حول ذرة الكربون الأنوميرية (C1) بعد تكوين الحلقة." },
                    { text: "صور متماثلة (Enantiomers)", correct: false, rationale: "الصور المتماثلة (مثل D-Glucose و L-Glucose) تكون صورة مرآة لبعضها عند *كل* ذرات الكربون غير المتماثلة." }
                ]
            },
            {
                question: "في الشكل الحلقي (Pyranose) لسكر الجلوكوز، ما الذي يحدد ما إذا كان السكر $\\alpha$ (ألفا) أو $\\beta$ (بيتا)؟",
                type: 'mc',
                answers: [
                    { text: "اتجاه مجموعة الهيدروكسيل (OH) على ذرة الكربون الأنوميرية (C1)", correct: true, rationale: "يتم تحديد ألفا وبيتا بناءً على اتجاه مجموعة الهيدروكسيل (OH) على ذرة الكربون رقم 1 (الكربون الأنومرية). إذا كانت (OH) إلى أسفل يكون ألفا (α)، وإذا كانت إلى أعلى يكون بيتا (β)." },
                    { text: "اتجاه مجموعة (OH) على ذرة الكربون C4", correct: false, rationale: "الاختلاف عند C4 يحدد الإبيمر (مثل الجلوكوز والجلاكتوز)، وليس الأنومر (ألفا أو بيتا)." },
                    { text: "اتجاه مجموعة (OH) على ذرة الكربون ما قبل الأخيرة (C5)", correct: false, rationale: "الاختلاف عند C5 (في السلسلة المفتوحة) يحدد ما إذا كان السكر D أو L." },
                    { text: "ما إذا كان السكر سداسي (Pyranose) أو خماسي (Furanose)", correct: false, rationale: "نوع الحلقة (بيرانوز أو فيورانوز) يحدد حجمها، ولكل منهما يمكن أن يوجد في شكلي ألفا وبيتا." }
                ]
            },
            {
                question: "صح أم خطأ: في سكر الفركتوز الحلقي (Furanose or Pyranose)، تعتبر ذرة الكربون رقم 2 (C2) هي ذرة الكربون الأنوميرية.",
                type: 'tf',
                answers: [
                    { text: "صح", correct: true, rationale: "لأن الفركتوز سكر كيتوني، فإن مجموعة الكيتون (C2) هي التي تتفاعل لتكوين الحلقة، وتصبح هي ذرة الكربون الأنوميرية." },
                    { text: "خطأ", correct: false, rationale: "ذرة الكربون C1 هي الذرة الأنوميرية في السكريات الألدوزية (مثل الجلوكوز)، أما في الكيتوزية (مثل الفركتوز) فهي C2." }
                ]
            },
            {
                question: "يتكون سكر السكروز (سكر المائدة) من ارتباط جزيئي...",
                type: 'mc',
                answers: [
                    { text: "$\\alpha$-جلوكوز و $\\alpha$-جلوكوز", correct: false, rationale: "هذا هو تركيب سكر المالتوز (سكر الشعير)." },
                    { text: "$\\beta$-جلوكوز و $\\beta$-جالاكتوز", correct: false, rationale: "هذا هو تركيب سكر اللاكتوز (سكر الحليب)." },
                    { text: "$\\alpha$-جلوكوز و $\\beta$-فركتوز", correct: true, rationale: "يتكون سكر السكروز من ارتباط جزيء α-جلوكوز و β-فركتوز." },
                    { text: "$\\beta$-فركتوز و $\\beta$-فركتوز", correct: false, rationale: "هذا هو أساس سكر الإنيولين (سكر عديد)، وليس السكروز (سكر ثنائي)." }
                ]
            },
            {
                question: "ما هي نوع الرابطة الجلايكوسيدية في سكر اللاكتوز (سكر الحليب)؟",
                type: 'mc',
                answers: [
                    { text: "$\\alpha-1\\rightarrow4$", correct: false, rationale: "هذه هي الرابطة الموجودة في سكر المالتوز وسلاسل الأميلوز المستقيمة في النشا." },
                    { text: "$\\beta-1\\rightarrow4$", correct: true, rationale: "يتكون اللاكتوز من ارتباط β-جالاكتوز مع جلوكوز برابطة جلايكوسيدية نوع β-1→4." },
                    { text: "$\\alpha-1\\rightarrow2$", correct: false, rationale: "هذه هي الرابطة المميزة لسكر السكروز (بين الجلوكوز والفركتوز)." },
                    { text: "$\\alpha-1\\rightarrow6$", correct: false, rationale: "هذه هي الرابطة الموجودة عند نقاط التفرع في الأميلوبكتين والجلايكوجين." }
                ]
            },
            {
                question: "صح أم خطأ: سكر السكروز يعتبر سكراً مختزلاً.",
                type: 'tf',
                answers: [
                    { text: "صح", correct: false, rationale: "السكروز سكر غير مختزل، وذلك لعدم وجود مجموعة ألدهيدية حرة. ذرات الكربون الأنوميرية (C1 في الجلوكوز و C2 في الفركتوز) كلاهما مشارك في الرابطة." },
                    { text: "خطأ", correct: true, rationale: "السكروز هو سكر غير مختزل. السكريات المختزلة (مثل المالتوز واللاكتوز) يجب أن تحتوي على مجموعة ألدهid حرة (ذرة كربون أنوميرية غير مرتبطة)." }
                ]
            },
            {
                question: "أي من السكريات العديدة التالية يعتبر \"غير متجانس\" (Heterogeneous)؟",
                type: 'mc',
                answers: [
                    { text: "النشا", correct: false, rationale: "النشا سكر عديد متجانس، لأنه يعطي نفس النوع من السكر (جلوكوز) عند تحلله." },
                    { text: "السيليلوز", correct: false, rationale: "السيليلوز سكر عديد متجانس، يتكون فقط من وحدات β-جلوكوز." },
                    { text: "الجلايكوجين", correct: false, rationale: "الجلايكوجين سكر عديد متجانس، يتكون فقط من وحدات α-جلوكوز." },
                    { text: "حمض الهايلويورونك", correct: true, rationale: "السكريات العديدة غير المتجانسة تعطي أكثر من نوع من السكر عند تحللها. حمض الهايلويورونك غير متجانس لأنه يتكون من وحدات متكررة من (Glucuronic Acid) و (N-Acetyl-D-glucosamine)." }
                ]
            },
            {
                question: "ما هي الوحدة البنائية الأساسية ونوع الرابطة في السيليلوز (Cellulose)؟",
                type: 'mc',
                answers: [
                    { text: "$\\alpha$-جلوكوز ، ورابطة $\\alpha-1\\rightarrow4$", correct: false, rationale: "هذا هو تركيب الأميلوز (الجزء المستقيم من النشا)." },
                    { text: "$\\beta$-جلوكوز ، ورابطة $\\beta-1\\rightarrow4$", correct: true, rationale: "يتكون السيليلوز من سلاسل مستقيمة غير متفرعة ناتجة من ارتباط وحدات β-جلوكوز بروابط β-1→4 جلايكوسيدية." },
                    { text: "$\\alpha$-جلوكوز ، وروابط $\\alpha-1\\rightarrow4$ و $\\alpha-1\\rightarrow6$", correct: false, rationale: "هذا هو تركيب الأميلوبكتين (الجزء المتفرع من النشا) والجلايكوجين." },
                    { text: "$\\beta$-فركتوز ، ورابطة $\\beta-1\\rightarrow2$", correct: false, rationale: "هذا هو تركيب سكر الإنيولين." }
                ]
            },
            {
                question: "ما هو السكر العديد (المتجانس) الذي يخزن في الكبد والعضلات في الحيوانات ويعتبر أكثر تفرعاً من الأميلوبكتين؟",
                type: 'mc',
                answers: [
                    { text: "النشا", correct: false, rationale: "النشا هو سكر التخزين في النباتات." },
                    { text: "السيليلوز", correct: false, rationale: "السيليلوز هو سكر تركيبي (بنائي) في جدار الخلية النباتية." },
                    { text: "الجلايكوجين", correct: true, rationale: "الجلايكوجين هو سكر التخزين الحيواني (في الكبد والعضلات)، ويشبه الأميلوبكتين لكنه يكون أكثر تفرعاً." },
                    { text: "الكيتين", correct: false, rationale: "الكيتين سكر تركيبي في الهيكل الخارجي للافقاريات." }
                ]
            }
        ];

        const questionElement = document.getElementById('question-text');
        const questionCounterElement = document.getElementById('question-counter');
        const answerButtonsElement = document.getElementById('answer-buttons');
        const nextButton = document.getElementById('next-btn');
        const quizContentElement = document.getElementById('quiz-content');
        const scoreContainerElement = document.getElementById('score-container');
        const rationaleElement = document.getElementById('rationale-text');

        let shuffledQuestions, currentQuestionIndex;
        let score = 0;
        let userAnswers = []; // <-- متغير جديد لتخزين إجابات المستخدم

        function startQuiz() {
            shuffledQuestions = questions.sort(() => Math.random() - 0.5);
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = []; // <-- إعادة تعيين مصفوفة الإجابات
            quizContentElement.classList.remove('hide');
            scoreContainerElement.innerHTML = ''; // <-- مسح النتائج والمراجعة القديمة
            scoreContainerElement.classList.add('hide');
            nextButton.classList.add('hide');
            showQuestion(shuffledQuestions[currentQuestionIndex]);
        }

        function showQuestion(question) {
            resetState();
            questionCounterElement.innerText = `السؤال ${currentQuestionIndex + 1} من ${questions.length}`;
            questionElement.innerText = question.question;
            
            question.answers.forEach(answer => {
                const button = document.createElement('button');
                button.innerText = answer.text;
                button.classList.add('btn');
                button.dataset.correct = answer.correct;
                // سنحتاج للوصول إلى التعليل الصحيح لاحقاً
                button.addEventListener('click', selectAnswer);
                answerButtonsElement.appendChild(button);
            });
        }

        function resetState() {
            nextButton.classList.add('hide');
            rationaleElement.style.display = 'none';
            rationaleElement.classList.remove('correct', 'incorrect');
            while (answerButtonsElement.firstChild) {
                answerButtonsElement.removeChild(answerButtonsElement.firstChild);
            }
        }

        function selectAnswer(e) {
            const selectedButton = e.target;
            const isCorrect = selectedButton.dataset.correct === 'true';
            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            const correctAnswer = currentQuestion.answers.find(ans => ans.correct === true);

            // إظهار التعليل الصحيح دائماً
            if (isCorrect) {
                score++;
                rationaleElement.classList.add('correct');
                rationaleElement.innerHTML = `<strong>أحسنت!</strong> ${correctAnswer.rationale}`;
            } else {
                rationaleElement.classList.add('incorrect');
                rationaleElement.innerHTML = `<strong>خطأ. الشرح:</strong> ${correctAnswer.rationale}`;
            }
            
            rationaleElement.style.display = 'block';

            // تخزين الإجابة للمراجعة
            userAnswers.push({
                questionText: currentQuestion.question,
                selectedAnswer: selectedButton.innerText,
                correctAnswer: correctAnswer.text,
                rationale: correctAnswer.rationale,
                isCorrect: isCorrect
            });

            // تعطيل الأزرار
            Array.from(answerButtonsElement.children).forEach(button => {
                setStatusClass(button, button.dataset.correct === 'true');
                button.disabled = true;
            });

            // إظهار زر "التالي"
            if (shuffledQuestions.length > currentQuestionIndex + 1) {
                nextButton.innerText = 'السؤال التالي';
            } else {
                nextButton.innerText = 'إظهار النتيجة والمراجعة';
            }
            nextButton.classList.remove('hide');
        }

        function setStatusClass(element, correct) {
            clearStatusClass(element);
            if (correct) {
                element.classList.add('correct');
            } else {
                element.classList.add('incorrect');
            }
        }

        function clearStatusClass(element) {
            element.classList.remove('correct');
            element.classList.remove('incorrect');
        }

        function handleNextButton() {
            currentQuestionIndex++;
            if (shuffledQuestions.length > currentQuestionIndex) {
                showQuestion(shuffledQuestions[currentQuestionIndex]);
            } else {
                showScoreAndReview();
            }
        }

        function showScoreAndReview() {
            quizContentElement.classList.add('hide');
            scoreContainerElement.classList.remove('hide');
            
            // 1. عرض النتيجة
            let scoreHTML = `
                <h2>النتيجة النهائية</h2>
                <p>لقد أجبت بشكل صحيح على ${score} من أصل ${questions.length} سؤال.</p>
            `;
            
            // 2. إنشاء حاوية المراجعة
            let reviewHTML = '<div id="review-container"><h2>مراجعة الاختبار</h2>';
            
            userAnswers.forEach((answer, index) => {
                reviewHTML += `
                    <div class="review-question">
                        <h4>السؤال ${index + 1}: ${answer.questionText}</h4>
                        <p class="user-answer">
                            <strong>إجابتك:</strong> ${answer.selectedAnswer} 
                            ${answer.isCorrect 
                                ? '<span class="correct-text">(صحيحة)</span>' 
                                : '<span class="incorrect-text">(خاطئة)</span>'}
                        </p>
                        ${!answer.isCorrect 
                            ? `<p class="correct-answer"><strong>الإجابة الصحيحة:</strong> ${answer.correctAnswer}</p>` 
                            : ''}
                        <p class="review-rationale"><strong>الشرح:</strong> ${answer.rationale}</p>
                    </div>
                `;
            });
            
            reviewHTML += '</div>';
            
            // 3. إنشاء زر إعادة الاختبار
            const restartButtonHTML = `
                <button class="btn" onclick="startQuiz()" style="margin-top: 20px; background-color: var(--primary-color); color: white; border: none;">
                    إعادة الاختبار
                </button>
            `;

            // 4. تجميع كل شيء وعرضه
            scoreContainerElement.innerHTML = scoreHTML + reviewHTML + restartButtonHTML;
        }

        nextButton.addEventListener('click', handleNextButton);

        // بدء الاختبار عند تحميل الصفحة
        startQuiz();
    </script>
</body>
</html>
